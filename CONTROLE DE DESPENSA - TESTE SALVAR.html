<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Controle de Despensa</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 10px; background-color: #f0f0f0; }
    h2 { background: #ff5733; color: white; padding: 10px; border-radius: 5px; text-align: center; }
    table { width: 100%; border-collapse: collapse; background: white; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background-color: #00b894; color: white; }
    input { width: 90%; padding: 5px; }
    button { margin: 10px 5px 0 0; padding: 10px; background: #6c5ce7; color: white; border: none; border-radius: 5px; }
  </style>
</head>
<body>
  <h2>Controle de Despensa</h2>
  <table id="estoqueTable">
    <thead>
      <tr>
        <th>Item</th>
        <th>Necess√°rio</th>
        <th>Atual</th>
        <th>Repor</th>
        <th>Valor</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>

  <button onclick="addRow()">‚ûï Adicionar Item</button>
  <button onclick="salvarDados()">üíæ Salvar Estoque</button>
  <button onclick="limparEstoque()">üóëÔ∏è Limpar Tudo</button>

  <script>
    function addRow(item = "", necessario = "", atual = "", valor = "") {
      const table = document.getElementById('tableBody');
      const row = table.insertRow();
      for (let i = 0; i < 5; i++) {
        const cell = row.insertCell(i);
        let input = document.createElement("input");
        input.type = (i === 3) ? "number" : "text";
        input.readOnly = (i === 3);
        input.style.backgroundColor = (i === 3) ? "#e0e0e0" : "white";
        input.oninput = () => calcularReposicao(row);
        if (i === 0) input.value = item;
        if (i === 1) input.value = necessario;
        if (i === 2) input.value = atual;
        if (i === 5) input.value = valor;
        cell.appendChild(input);
      }
      calcularReposicao(row);
    }

    function calcularReposicao(row) {
      const necessario = parseFloat(row.cells[1].children[0].value) || 0;
      const atual = parseFloat(row.cells[2].children[0].value) || 0;
      row.cells[3].children[0].value = Math.max(necessario - atual, 0);
    }

    function salvarDados() {
      const linhas = [];
      const rows = document.getElementById("tableBody").rows;
      for (let row of rows) {
        let item = row.cells[0].children[0].value;
        let nec = row.cells[1].children[0].value;
        let atual = row.cells[2].children[0].value;
        let valor = row.cells[5].children[0].value;
        linhas.push({ item, necessario: nec, atual, valor });
      }
      localStorage.setItem("estoque", JSON.stringify(linhas));
      alert("Estoque salvo com sucesso!");
    }

    function carregarDados() {
      const dados = JSON.parse(localStorage.getItem("estoque") || "[]");
      for (let linha of dados) {
        addRow(linha.item, linha.necessario, linha.atual, linha.valor);
      }
    }

    function limparEstoque() {
      if (confirm("Tem certeza que deseja limpar todos os dados?")) {
        localStorage.removeItem("estoque");
        document.getElementById("tableBody").innerHTML = "";
      }
    }

    window.onload = carregarDados;
  </script>
</body>
</html>
